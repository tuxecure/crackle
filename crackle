#!/bin/bash
PKG_PATH=${PKG_PATH:-/home/pkgs};
[ "$1" = "clean" ] && {
    apt-get $1;
    find -L $PKG_PATH/bin -wholename $PKG_PATH/bin -o -type d -prune -o -type l -exec rm {} +;
    find -L $PKG_PATH/lib -wholename $PKG_PATH/lib -o -type d -prune -o -type l -exec rm {} +;
    exit 0;
}
[[ "$1" = "install" || "$1" = "crack" ]] && {
[ "$1" = "install" ] && { [ -d "$PKG_PATH" ] || mkdir $PKG_PATH; }
[[ "$1" = "crack" ]] && { op="install"; dir="packages/$2"; } || { op="$1"; dir="$PKG_PATH"; }
apt-get clean;
apt-get $op --download-only $2;
readarray -t packages < <(ls /var/cache/apt/archives/*.deb);
for package in "${packages[@]}"
    do
        dpkg-deb -xv $package $dir;
    done;
}
